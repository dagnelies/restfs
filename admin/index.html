<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Editable Tree - jQuery EasyUI Demo</title>
    <link rel="stylesheet" type="text/css" href="easyui-1.4.5/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="easyui-1.4.5/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="ext/_ext-icons.css">
    <link rel="stylesheet" type="text/css" href="easyui-ribbon/ribbon.css">
    <link rel="stylesheet" type="text/css" href="easyui-ribbon/ribbon-icon.css">
    
    <script type="text/javascript" src="easyui-1.4.5/jquery.min.js"></script>
    <script type="text/javascript" src="easyui-1.4.5/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="easyui-ribbon/jquery.ribbon.js"></script>

    <style>
        html, body {
            height: 100%;
            padding: 0px;
            margin: 0px;
        }
    </style>
</head>
<body>
    
    <div class="easyui-layout" style="width:100%;height:100%;">
        <div data-options="region:'north'" style="height:141px;">
            <div class="easyui-ribbon">
                <div title="Home">
                    <div class="ribbon-group">
                        <div class="ribbon-toolbar">
                            <a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-paste-large',iconAlign:'top',size:'large',plain:true">New file</a>
                            <a href="#" class="easyui-linkbutton" data-options="name:'paste',iconCls:'icon-new-large',iconAlign:'top',size:'large',plain:true">Rename</a>
                            <a href="#" class="easyui-linkbutton" data-options="name:'paste',iconCls:'icon-new-large',iconAlign:'top',size:'large'">Copy</a>
                            <a href="#" class="easyui-linkbutton" data-options="name:'paste',iconCls:'icon-new-large',iconAlign:'top',size:'large'">Paste</a>
                            <a href="#" class="easyui-linkbutton" data-options="name:'paste',iconCls:'icon-new-large',iconAlign:'top',size:'large'">Delete</a>
                        </div>
                        <div class="ribbon-toolbar">
                            <a href="#" class="easyui-linkbutton" data-options="name:'paste',iconCls:'icon-new-large',iconAlign:'top',size:'large'">New directory</a>
                            
                        </div>
                        <div class="ribbon-group-title">Clipboard</div>
                    </div>
                    <div class="ribbon-group-sep"></div>
                    <div class="ribbon-group">
                        <div class="ribbon-toolbar" style="width:200px"></div>
                        <div class="ribbon-group-title">other title</div>
                    </div>
                    <div class="ribbon-group-sep"></div>
                </div>
            </div>
        </div>
        <div data-options="region:'west',split:true" style="width:20%;">
            <ul id="filetree"></ul>
        </div>
        <div data-options="region:'center'">
            <table class="easyui-datagrid"
                    data-options="border: false, fit:true,fitColumns:true">
                <thead>
                    <tr>
                        <th data-options="field:'name'">Name</th>
                        <th data-options="field:'last_modified'">Last modified</th>
                        <th data-options="field:'size',align:'right'">Size</th>
                    </tr>
                </thead>
            </table>
        </div>
        <div data-options="region:'east',split:true" style="width:100px;"></div>
        <div data-options="region:'south',split:true" style="height:50px;"></div>
    </div>
    
    
    
    <script>
    $('#filetree').tree({
        animate: true,
        lines: true,
        dnd: true,
        loader: function(param,success,error) {
            console.log(param)
            $.ajax({
                method: 'GET',
                url:  '/@files/' + (param.id ? param.id : ''),
                success: success,
                error: error
            })
            return true
        },
        loadFilter: function(res){
            console.log(res);
            var nodes = res.files.map( function(n) {
                var node = {
                    id : res.path + '/' + n.name,
                    text: n.name
                };
                if( n.isdir ) {
                    node.state = "closed";
                }
                else if( n.name.indexOf('.') > 0 ) {
                    var ext = n.name.split('.').pop();
                    node.iconCls = 'icon-' + ext;
                }
                return node;
            });
            console.log(nodes);
            return nodes;
        }
    });
    
    </script>
</body>
</html>